@{
    ViewData["Title"] = "é¢¨éšªè©•ä¼°å•å·";
    var isDevelopment = ViewData["IsDevelopment"] as bool? ?? false;
    var environment = ViewData["Environment"] as string ?? "Production";
}

<div class="app-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-brand">
                <div class="sidebar-logo">
                    <img src="~/images/logo.svg" alt="æ™ºåºè³‡è¨Š" class="logo-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';" />
                    <svg class="logo-svg" style="display:none;" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="20" y="20" width="40" height="120" stroke="currentColor" stroke-width="2" fill="none"/>
                        <rect x="60" y="60" width="60" height="40" stroke="currentColor" stroke-width="2" fill="none"/>
                        <rect x="60" y="100" width="40" height="40" stroke="currentColor" stroke-width="2" fill="none"/>
                        <path d="M140 20 L140 80 L180 80 L180 60 L160 60 L160 20 Z" stroke="currentColor" stroke-width="2" fill="none"/>
                        <path d="M140 100 L140 140 L180 140 L180 120 L160 120 L160 100 Z" stroke="currentColor" stroke-width="2" fill="none"/>
                        <path d="M120 140 L120 160 L180 160 L180 140 Z" stroke="currentColor" stroke-width="2" fill="none"/>
                        <rect x="140" y="20" width="40" height="20" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                </div>
                <div class="sidebar-brand-text">
                    <h2 class="sidebar-title">DocEngine</h2>
                    <p class="sidebar-subtitle">æ™ºåºè³‡è¨Š</p>
                </div>
            </div>
            <button class="sidebar-close" id="sidebarClose" aria-label="Close sidebar">
                <span></span>
                <span></span>
            </button>
        </div>
        <nav class="sidebar-nav">
            <a href="@Url.Action("Index", "Home")" class="nav-item" data-page="dashboard">
                <span class="nav-icon">ğŸ“Š</span>
                <span class="nav-text" data-i18n="Nav.Dashboard">å„€è¡¨æ¿</span>
            </a>
            <a href="@Url.Action("Projects", "Home")" class="nav-item" data-page="projects">
                <span class="nav-icon">ğŸ“</span>
                <span class="nav-text" data-i18n="Nav.Projects">å°ˆæ¡ˆ</span>
            </a>
            <a href="@Url.Action("Assessment", "Home")" class="nav-item active" data-page="assessment">
                <span class="nav-icon">ğŸ“</span>
                <span class="nav-text" data-i18n="Nav.Assessment">è©•ä¼°</span>
            </a>
            <a href="@Url.Action("Report", "Home")" class="nav-item" data-page="report">
                <span class="nav-icon">ğŸ“‹</span>
                <span class="nav-text" data-i18n="Nav.Report">å ±å‘Š</span>
            </a>
            <a href="@Url.Action("Documentation", "Home")" class="nav-item" data-page="documentation">
                <span class="nav-icon">ğŸ“„</span>
                <span class="nav-text" data-i18n="Nav.Documentation">æ–‡ä»¶</span>
            </a>
            <a href="@Url.Action("Risks", "Home")" class="nav-item" data-page="risks">
                <span class="nav-icon">âš ï¸</span>
                <span class="nav-text" data-i18n="Nav.Risks">é¢¨éšª</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Mobile Header with Hamburger and Language Switcher -->
        <header class="mobile-header">
            <button class="hamburger" id="hamburger" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <h1 class="mobile-title">DocEngine</h1>
            <div class="mobile-header-actions">
                <div class="language-switcher-top">
                    <button class="lang-btn-top" onclick="i18n.setLang('zh-TW')" data-lang="zh-TW">
                        <span data-i18n="Common.Chinese">ç¹é«”ä¸­æ–‡</span>
                    </button>
                    <button class="lang-btn-top" onclick="i18n.setLang('en-US')" data-lang="en-US">
                        <span data-i18n="Common.English">English</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Page Content -->
        <div class="content-wrapper">
            <!-- Desktop Header with Language Switcher -->
            <div class="desktop-header">
                <div class="survey-header">
                    <h1 class="survey-title" data-i18n="Assessment.Title">é¢¨éšªè©•ä¼°å•å·</h1>
                    <p class="survey-subtitle" data-i18n="Assessment.Subtitle">è«‹æ ¹æ“šæ‚¨çš„å°ˆæ¡ˆç¾æ³ï¼Œè©•ä¼°ä»¥ä¸‹å„é …æŒ‡æ¨™ï¼ˆ0-10åˆ†ï¼‰</p>
                    <div class="maturity-info-box">
                        <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                        <span class="info-text">
                            <strong data-i18n="Assessment.MaturityLabel">M = æˆç†Ÿåº¦ (Maturity)</strong>
                            <span data-i18n="Assessment.MaturityDesc">ï¼šè©•ä¼°å„é …æµç¨‹èˆ‡èƒ½åŠ›çš„æˆç†Ÿç¨‹åº¦ï¼Œåˆ†æ•¸è¶Šé«˜è¡¨ç¤ºè©²é ˜åŸŸè¶Šæˆç†Ÿ</span>
                        </span>
                    </div>
                </div>
                <div class="header-actions">
                    <div class="language-switcher-top">
                        <button class="lang-btn-top" onclick="i18n.setLang('zh-TW')" data-lang="zh-TW">
                            <span data-i18n="Common.Chinese">ç¹é«”ä¸­æ–‡</span>
                        </button>
                        <button class="lang-btn-top" onclick="i18n.setLang('en-US')" data-lang="en-US">
                            <span data-i18n="Common.English">English</span>
                        </button>
                    </div>
                </div>
            </div>

            <form id="surveyForm" class="survey-form">
                <!-- Project Info Input -->
                <div class="survey-section">
                    <div class="question-card system-name-card">
                        <label class="question-label" for="projectName" data-i18n="Assessment.ProjectNameLabel">å°ˆæ¡ˆåç¨±</label>
                        <input type="text" 
                               class="question-input" 
                               id="projectName" 
                               name="projectName" 
                               data-placeholder-i18n="Assessment.ProjectNamePlaceholder"
                               placeholder="è«‹è¼¸å…¥å°ˆæ¡ˆåç¨±">
                    </div>
                    <div class="question-card system-name-card">
                        <label class="question-label" for="systemName" data-i18n="Assessment.SystemNameLabel">ç³»çµ±åç¨±</label>
                        <input type="text" 
                               class="question-input" 
                               id="systemName" 
                               name="systemName" 
                               data-placeholder-i18n="Assessment.SystemNamePlaceholder"
                               placeholder="è«‹è¼¸å…¥è¦è©•ä¼°çš„ç³»çµ±åç¨±">
                    </div>
                    <div class="question-card system-name-card">
                        <label class="question-label" for="systemCode" data-i18n="Assessment.SystemCodeLabel">ç³»çµ±ä»£è™Ÿ</label>
                        <input type="text" 
                               class="question-input" 
                               id="systemCode" 
                               name="systemCode" 
                               data-placeholder-i18n="Assessment.SystemCodePlaceholder"
                               placeholder="è«‹è¼¸å…¥ç³»çµ±ä»£è™Ÿï¼ˆå¦‚ï¼šADMï¼‰"
                               maxlength="10"
                               style="text-transform: uppercase;">
                    </div>
                    <div class="question-card system-name-card">
                        <label class="question-label" for="evaluatorRole" data-i18n="Assessment.EvaluatorRoleLabel">è©•ä¼°äººè§’è‰²</label>
                        <input type="text" 
                               class="question-input" 
                               id="evaluatorRole" 
                               name="evaluatorRole" 
                               list="roleSuggestions"
                               data-placeholder-i18n="Assessment.EvaluatorRolePlaceholder"
                               placeholder="è«‹è¼¸å…¥æˆ–é¸æ“‡è©•ä¼°äººè§’è‰²ï¼ˆå¦‚ï¼šPMã€SAã€PGç­‰ï¼‰">
                        <datalist id="roleSuggestions">
                            <option value="PM">PM (Project Manager - å°ˆæ¡ˆç¶“ç†)</option>
                            <option value="SA">SA (System Analyst - ç³»çµ±åˆ†æå¸«)</option>
                            <option value="PG">PG (Programmer - ç¨‹å¼è¨­è¨ˆå¸«)</option>
                            <option value="PL">PL (Project Leader - å°ˆæ¡ˆè² è²¬äºº)</option>
                            <option value="SD">SD (System Designer - ç³»çµ±è¨­è¨ˆå¸«)</option>
                            <option value="SE">SE (System Engineer - ç³»çµ±å·¥ç¨‹å¸«)</option>
                            <option value="BA">BA (Business Analyst - æ¥­å‹™åˆ†æå¸«)</option>
                            <option value="QA">QA (Quality Assurance - å“è³ªä¿è­‰)</option>
                            <option value="DBA">DBA (Database Administrator - è³‡æ–™åº«ç®¡ç†å“¡)</option>
                            <option value="DevOps">DevOps (Development Operations - é–‹ç™¼é‹ç¶­å·¥ç¨‹å¸«)</option>
                            <option value="SRE">SRE (Site Reliability Engineering - ç«™é»å¯é æ€§å·¥ç¨‹å¸«)</option>
                        </datalist>
                    </div>
                </div>

                <!-- Fixed Questions -->
                <div class="survey-section fixed-questions-grid">
                    <div class="question-card">
                        <div class="question-header">
                            <label class="question-label" data-i18n="Assessment.M1">M1 ç³»çµ±äº¤æ¥</label>
                        </div>
                        <p class="question-description" data-i18n="Assessment.M1Desc">æ–°äººä¸éœ€1å€‹æœˆä¸Šæ‰‹ï¼Ÿ</p>
                        <div class="slider-container">
                            <input type="range" class="slider" id="M1" name="M1" min="0" max="10" value="5" step="1">
                            <div class="slider-labels">
                                <span>0</span>
                                <span>5</span>
                                <span>10</span>
                            </div>
                            <div class="score-description" id="desc-M1">
                                <span class="score-value-inline" id="value-M1">5</span>
                                <span class="score-text" data-i18n="Score.M1.5">ä¸­ç­‰ï¼šæ–°äººéœ€è¦1-2å€‹æœˆæ‰èƒ½ä¸Šæ‰‹</span>
                            </div>
                        </div>
                    </div>

                    <div class="question-card">
                        <div class="question-header">
                            <label class="question-label" data-i18n="Assessment.M2">M2 éœ€æ±‚è¿½æº¯</label>
                        </div>
                        <p class="question-description" data-i18n="Assessment.M2Desc">è¨­è¨ˆæ±ºç­–èƒ½æ‰¾åˆ°ä¾æ“šï¼Ÿ</p>
                        <div class="slider-container">
                            <input type="range" class="slider" id="M2" name="M2" min="0" max="10" value="5" step="1">
                            <div class="slider-labels">
                                <span>0</span>
                                <span>5</span>
                                <span>10</span>
                            </div>
                            <div class="score-description" id="desc-M2">
                                <span class="score-value-inline" id="value-M2">5</span>
                                <span class="score-text" data-i18n="Score.M2.5">ä¸­ç­‰ï¼šéƒ¨åˆ†è¨­è¨ˆæ±ºç­–æœ‰ä¾æ“šï¼Œä½†ä¸å®Œæ•´</span>
                            </div>
                        </div>
                    </div>

                    <div class="question-card question-featured">
                        <div class="question-header">
                            <label class="question-label" data-i18n="Assessment.M3">M3 è®Šæ›´é æ¸¬</label>
                        </div>
                        <p class="question-description" data-i18n="Assessment.M3Desc">æ”¹éœ€æ±‚å‰èƒ½é çŸ¥å½±éŸ¿ï¼Ÿ</p>
                        <div class="slider-container">
                            <input type="range" class="slider" id="M3" name="M3" min="0" max="10" value="5" step="1">
                            <div class="slider-labels">
                                <span>0</span>
                                <span>5</span>
                                <span>10</span>
                            </div>
                            <div class="score-description" id="desc-M3">
                                <span class="score-value-inline" id="value-M3">5</span>
                                <span class="score-text" data-i18n="Score.M3.5">ä¸­ç­‰ï¼šèƒ½é æ¸¬éƒ¨åˆ†å½±éŸ¿ï¼Œä½†å¯èƒ½éºæ¼</span>
                            </div>
                        </div>
                    </div>

                    <div class="question-card">
                        <div class="question-header">
                            <label class="question-label" data-i18n="Assessment.M4">M4 é©—æ”¶æ¨™æº–</label>
                        </div>
                        <p class="question-description" data-i18n="Assessment.M4Desc">åœ˜éšŠå°ã€Œå®Œæˆã€ç†è§£ä¸€è‡´ï¼Ÿ</p>
                        <div class="slider-container">
                            <input type="range" class="slider" id="M4" name="M4" min="0" max="10" value="5" step="1">
                            <div class="slider-labels">
                                <span>0</span>
                                <span>5</span>
                                <span>10</span>
                            </div>
                            <div class="score-description" id="desc-M4">
                                <span class="score-value-inline" id="value-M4">5</span>
                                <span class="score-text" data-i18n="Score.M4.5">ä¸­ç­‰ï¼šå¤§éƒ¨åˆ†ç†è§£ä¸€è‡´ï¼Œå¶æœ‰æ­§ç¾©</span>
                            </div>
                        </div>
                    </div>

                    <div class="question-card">
                        <div class="question-header">
                            <label class="question-label" data-i18n="Assessment.M5">M5 æºé€šæˆæœ¬</label>
                        </div>
                        <p class="question-description" data-i18n="Assessment.M5Desc">è·¨è§’è‰²å°é½Šéœ€å¹¾æ¬¡æœƒè­°ï¼Ÿ</p>
                        <div class="slider-container">
                            <input type="range" class="slider" id="M5" name="M5" min="0" max="10" value="5" step="1">
                            <div class="slider-labels">
                                <span>0</span>
                                <span>5</span>
                                <span>10</span>
                            </div>
                            <div class="score-description" id="desc-M5">
                                <span class="score-value-inline" id="value-M5">5</span>
                                <span class="score-text" data-i18n="Score.M5.5">ä¸­ç­‰ï¼šéœ€è¦2-3æ¬¡æœƒè­°æ‰èƒ½å°é½Š</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Open Questions -->
                <div class="survey-section">
                    <h2 class="section-title" style="margin-bottom: 12px;">é–‹æ”¾å¼å•é¡Œ</h2>
                    <div class="question-card">
                        <label class="question-label" for="open1" data-i18n="Assessment.OpenQ6">å•é¡Œ 6. è«‹æè¿°æ‚¨çš„å°ˆæ¡ˆé¢è‡¨çš„ä¸»è¦æŒ‘æˆ°...</label>
                        <textarea class="question-textarea" id="open1" name="open1" rows="2" data-placeholder-i18n="Assessment.PlaceholderQ6" placeholder="ä¾‹å¦‚ï¼šéœ€æ±‚è®Šæ›´é »ç¹ã€æŠ€è¡“å‚µå‹™ç´¯ç©ã€åœ˜éšŠæˆå“¡æµå‹•ç‡é«˜ã€è·¨éƒ¨é–€æºé€šå›°é›£ã€æ–‡ä»¶ç¶­è­·ä¸åŠæ™‚..."></textarea>
                    </div>

                    <div class="question-card">
                        <label class="question-label" for="open2" data-i18n="Assessment.OpenQ7">å•é¡Œ 7. è«‹èªªæ˜æ‚¨æœŸæœ›æ”¹å–„çš„é ˜åŸŸ...</label>
                        <textarea class="question-textarea" id="open2" name="open2" rows="2" data-placeholder-i18n="Assessment.PlaceholderQ7" placeholder="ä¾‹å¦‚ï¼šå»ºç«‹æ›´å®Œå–„çš„éœ€æ±‚è¿½æº¯æ©Ÿåˆ¶ã€æå‡æ–‡ä»¶å“è³ªèˆ‡å®Œæ•´æ€§ã€å„ªåŒ–è®Šæ›´ç®¡ç†æµç¨‹ã€åŠ å¼·åœ˜éšŠå”ä½œæ•ˆç‡..."></textarea>
                    </div>

                    <div class="question-card">
                        <label class="question-label" for="open3" data-i18n="Assessment.OpenQ8">å•é¡Œ 8. è«‹æä¾›å…¶ä»–ç›¸é—œè³‡è¨Š...</label>
                        <textarea class="question-textarea" id="open3" name="open3" rows="2" data-placeholder-i18n="Assessment.PlaceholderQ8" placeholder="ä¾‹å¦‚ï¼šå°ˆæ¡ˆè¦æ¨¡ã€åœ˜éšŠäººæ•¸ã€é–‹ç™¼é€±æœŸã€ä½¿ç”¨çš„æŠ€è¡“æ£§ã€ç‰¹æ®Šæ¥­å‹™éœ€æ±‚ç­‰..."></textarea>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="survey-footer">
                    <!-- è¼‰å…¥å‰æ¬¡å¡«å¯«çš„è³‡æ–™æŒ‰éˆ•ï¼ˆåƒ…åœ¨é–‹ç™¼ç’°å¢ƒé¡¯ç¤ºï¼‰ -->
                    @if (ViewData["IsDevelopment"] as bool? == true)
                    {
                        <button type="button" id="loadPreviousDataBtn" onclick="loadPreviousData()" 
                                class="dev-only"
                                style="margin-right: 12px; padding: 8px 16px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">
                            ğŸ“‹ å¸¶å…¥å‰æ¬¡å¡«å¯«çš„è³‡æ–™
                        </button>
                    }
                    <button type="button" onclick="goToPayment()" class="submit-button">
                        <span class="submit-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M5 12h14"></path>
                                <path d="M12 5l7 7-7 7"></path>
                            </svg>
                        </span>
                        <span data-i18n="Common.GenerateReport">ç”Ÿæˆå ±å‘Š</span> <span data-i18n="Common.Price">NT$2,990</span>
                    </button>
                </div>
            </form>
        </div>
    </main>

    <!-- Overlay for mobile -->
    <div class="overlay" id="overlay"></div>
</div>

@section Scripts {
    <script>
        // Sidebar toggle functionality
        const hamburger = document.getElementById('hamburger');
        const sidebar = document.getElementById('sidebar');
        const sidebarClose = document.getElementById('sidebarClose');
        const overlay = document.getElementById('overlay');
        const navItems = document.querySelectorAll('.nav-item');

        // Toggle sidebar
        function toggleSidebar() {
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
            document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
        }

        hamburger?.addEventListener('click', toggleSidebar);
        sidebarClose?.addEventListener('click', toggleSidebar);
        overlay?.addEventListener('click', toggleSidebar);

        // Handle nav item clicks
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                if (this.getAttribute('href') === '#') {
                    e.preventDefault();
                }
                
                // Remove active class from all items
                navItems.forEach(nav => nav.classList.remove('active'));
                
                // Add active class to clicked item
                this.classList.add('active');
                
                // Close sidebar on mobile after selection
                if (window.innerWidth <= 768) {
                    toggleSidebar();
                }
            });
        });

        // Close sidebar on window resize if desktop
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        // Score descriptions for each metric - will be populated from i18n
        const scoreDescriptions = {
            'M1': {},
            'M2': {},
            'M3': {},
            'M4': {},
            'M5': {}
        };

        // Function to load score descriptions from i18n
        function loadScoreDescriptions() {
            const lang = i18n.currentLang;
            const descriptions = {
                'zh-TW': {
                    'M1': {
                        0: 'æ¥µå·®ï¼šæ–°äººéœ€è¦3å€‹æœˆä»¥ä¸Šæ‰èƒ½ä¸Šæ‰‹',
                        1: 'å¾ˆå·®ï¼šæ–°äººéœ€è¦2-3å€‹æœˆæ‰èƒ½ä¸Šæ‰‹',
                        2: 'å·®ï¼šæ–°äººéœ€è¦2å€‹æœˆæ‰èƒ½ä¸Šæ‰‹',
                        3: 'è¼ƒå·®ï¼šæ–°äººéœ€è¦1.5-2å€‹æœˆæ‰èƒ½ä¸Šæ‰‹',
                        4: 'åä½ï¼šæ–°äººéœ€è¦1-1.5å€‹æœˆæ‰èƒ½ä¸Šæ‰‹',
                        5: 'ä¸­ç­‰ï¼šæ–°äººéœ€è¦1-2å€‹æœˆæ‰èƒ½ä¸Šæ‰‹',
                        6: 'å°šå¯ï¼šæ–°äººéœ€è¦0.5-1å€‹æœˆæ‰èƒ½ä¸Šæ‰‹',
                        7: 'è‰¯å¥½ï¼šæ–°äººéœ€è¦2-4é€±æ‰èƒ½ä¸Šæ‰‹',
                        8: 'å¾ˆå¥½ï¼šæ–°äººéœ€è¦1-2é€±æ‰èƒ½ä¸Šæ‰‹',
                        9: 'å„ªç§€ï¼šæ–°äººéœ€è¦1é€±å…§å°±èƒ½ä¸Šæ‰‹',
                        10: 'æ¥µä½³ï¼šæ–°äººå¹¾ä¹ä¸éœ€è¦åŸ¹è¨“å°±èƒ½ä¸Šæ‰‹'
                    },
                    'M2': {
                        0: 'æ¥µå·®ï¼šå®Œå…¨æ‰¾ä¸åˆ°è¨­è¨ˆæ±ºç­–çš„ä¾æ“š',
                        1: 'å¾ˆå·®ï¼šå¹¾ä¹æ‰¾ä¸åˆ°è¨­è¨ˆæ±ºç­–çš„ä¾æ“š',
                        2: 'å·®ï¼šå¤§éƒ¨åˆ†è¨­è¨ˆæ±ºç­–æ‰¾ä¸åˆ°ä¾æ“š',
                        3: 'è¼ƒå·®ï¼šå¾ˆå¤šè¨­è¨ˆæ±ºç­–æ‰¾ä¸åˆ°ä¾æ“š',
                        4: 'åä½ï¼šéƒ¨åˆ†è¨­è¨ˆæ±ºç­–æ‰¾ä¸åˆ°ä¾æ“š',
                        5: 'ä¸­ç­‰ï¼šéƒ¨åˆ†è¨­è¨ˆæ±ºç­–æœ‰ä¾æ“šï¼Œä½†ä¸å®Œæ•´',
                        6: 'å°šå¯ï¼šå¤§éƒ¨åˆ†è¨­è¨ˆæ±ºç­–æœ‰ä¾æ“š',
                        7: 'è‰¯å¥½ï¼šçµ•å¤§éƒ¨åˆ†è¨­è¨ˆæ±ºç­–éƒ½æœ‰ä¾æ“š',
                        8: 'å¾ˆå¥½ï¼šæ‰€æœ‰è¨­è¨ˆæ±ºç­–éƒ½æœ‰æ¸…æ¥šä¾æ“š',
                        9: 'å„ªç§€ï¼šè¨­è¨ˆæ±ºç­–èˆ‡éœ€æ±‚å®Œå…¨å°æ‡‰',
                        10: 'æ¥µä½³ï¼šè¨­è¨ˆæ±ºç­–æœ‰å®Œæ•´è¿½æº¯éˆï¼Œå¯è¿½åˆ°åŸå§‹éœ€æ±‚'
                    },
                    'M3': {
                        0: 'æ¥µå·®ï¼šå®Œå…¨ç„¡æ³•é æ¸¬è®Šæ›´å½±éŸ¿',
                        1: 'å¾ˆå·®ï¼šå¹¾ä¹ç„¡æ³•é æ¸¬è®Šæ›´å½±éŸ¿',
                        2: 'å·®ï¼šåªèƒ½é æ¸¬éƒ¨åˆ†æ˜é¡¯å½±éŸ¿',
                        3: 'è¼ƒå·®ï¼šèƒ½é æ¸¬ä¸»è¦å½±éŸ¿ï¼Œä½†æœƒéºæ¼æ¬¡è¦å½±éŸ¿',
                        4: 'åä½ï¼šèƒ½é æ¸¬å¤§éƒ¨åˆ†å½±éŸ¿ï¼Œä½†å¯èƒ½éºæ¼ç´°ç¯€',
                        5: 'ä¸­ç­‰ï¼šèƒ½é æ¸¬ä¸»è¦å½±éŸ¿å’Œå¤§éƒ¨åˆ†æ¬¡è¦å½±éŸ¿',
                        6: 'å°šå¯ï¼šèƒ½é æ¸¬å¤§éƒ¨åˆ†å½±éŸ¿ï¼ŒåŒ…æ‹¬ä¸»è¦å’Œæ¬¡è¦',
                        7: 'è‰¯å¥½ï¼šèƒ½é æ¸¬çµ•å¤§éƒ¨åˆ†å½±éŸ¿ï¼Œå¾ˆå°‘éºæ¼',
                        8: 'å¾ˆå¥½ï¼šèƒ½æº–ç¢ºé æ¸¬æ‰€æœ‰ä¸»è¦å½±éŸ¿å’Œå¤§éƒ¨åˆ†æ¬¡è¦å½±éŸ¿',
                        9: 'å„ªç§€ï¼šèƒ½æº–ç¢ºé æ¸¬æ‰€æœ‰å½±éŸ¿ï¼ŒåŒ…æ‹¬ç´°ç¯€å’Œé–“æ¥å½±éŸ¿',
                        10: 'æ¥µä½³ï¼šèƒ½å®Œæ•´é æ¸¬è®Šæ›´çš„æ‰€æœ‰å½±éŸ¿ï¼ŒåŒ…æ‹¬ç›´æ¥ã€é–“æ¥å’Œæ½›åœ¨å½±éŸ¿'
                    },
                    'M4': {
                        0: 'æ¥µå·®ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€çš„ç†è§£å®Œå…¨ä¸ä¸€è‡´',
                        1: 'å¾ˆå·®ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€çš„ç†è§£å·®ç•°å¾ˆå¤§',
                        2: 'å·®ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€çš„ç†è§£ç¶“å¸¸ä¸ä¸€è‡´',
                        3: 'è¼ƒå·®ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€çš„ç†è§£æ™‚å¸¸ä¸ä¸€è‡´',
                        4: 'åä½ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€çš„ç†è§£å¶çˆ¾ä¸ä¸€è‡´',
                        5: 'ä¸­ç­‰ï¼šå¤§éƒ¨åˆ†ç†è§£ä¸€è‡´ï¼Œå¶æœ‰æ­§ç¾©',
                        6: 'å°šå¯ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€çš„ç†è§£åŸºæœ¬ä¸€è‡´',
                        7: 'è‰¯å¥½ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€çš„ç†è§£é«˜åº¦ä¸€è‡´',
                        8: 'å¾ˆå¥½ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€çš„ç†è§£å¹¾ä¹å®Œå…¨ä¸€è‡´',
                        9: 'å„ªç§€ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€æœ‰æ˜ç¢ºä¸”ä¸€è‡´çš„æ¨™æº–',
                        10: 'æ¥µä½³ï¼šåœ˜éšŠå°ã€Œå®Œæˆã€æœ‰å®Œæ•´ä¸”çµ±ä¸€çš„å®šç¾©ï¼Œç„¡æ­§ç¾©'
                    },
                    'M5': {
                        0: 'æ¥µå·®ï¼šéœ€è¦5æ¬¡ä»¥ä¸Šæœƒè­°æ‰èƒ½å°é½Š',
                        1: 'å¾ˆå·®ï¼šéœ€è¦4-5æ¬¡æœƒè­°æ‰èƒ½å°é½Š',
                        2: 'å·®ï¼šéœ€è¦3-4æ¬¡æœƒè­°æ‰èƒ½å°é½Š',
                        3: 'è¼ƒå·®ï¼šéœ€è¦3æ¬¡æœƒè­°æ‰èƒ½å°é½Š',
                        4: 'åä½ï¼šéœ€è¦2-3æ¬¡æœƒè­°æ‰èƒ½å°é½Š',
                        5: 'ä¸­ç­‰ï¼šé€šå¸¸éœ€è¦2æ¬¡æœƒè­°æ‰èƒ½å°é½Š',
                        6: 'å°šå¯ï¼šéœ€è¦1-2æ¬¡æœƒè­°å°±èƒ½å°é½Š',
                        7: 'è‰¯å¥½ï¼šé€šå¸¸1æ¬¡æœƒè­°å°±èƒ½å°é½Š',
                        8: 'å¾ˆå¥½ï¼šå¤§éƒ¨åˆ†æƒ…æ³1æ¬¡æœƒè­°å°±èƒ½å°é½Š',
                        9: 'å„ªç§€ï¼šå¹¾ä¹ä¸éœ€è¦æœƒè­°ï¼Œæºé€šé †æš¢',
                        10: 'æ¥µä½³ï¼šå®Œå…¨ä¸éœ€è¦é¡å¤–æœƒè­°ï¼Œæºé€šæ•ˆç‡æ¥µé«˜'
                    }
                },
                'en-US': {
                    'M1': {
                        0: 'Very Poor: New team members need more than 3 months to get up to speed',
                        1: 'Poor: New team members need 2-3 months to get up to speed',
                        2: 'Below Average: New team members need 2 months to get up to speed',
                        3: 'Fair: New team members need 1.5-2 months to get up to speed',
                        4: 'Below Medium: New team members need 1-1.5 months to get up to speed',
                        5: 'Medium: New team members need 1-2 months to get up to speed',
                        6: 'Above Average: New team members need 0.5-1 month to get up to speed',
                        7: 'Good: New team members need 2-4 weeks to get up to speed',
                        8: 'Very Good: New team members need 1-2 weeks to get up to speed',
                        9: 'Excellent: New team members can get up to speed within 1 week',
                        10: 'Outstanding: New team members can get up to speed with almost no training'
                    },
                    'M2': {
                        0: 'Very Poor: Cannot find any basis for design decisions',
                        1: 'Poor: Almost cannot find any basis for design decisions',
                        2: 'Below Average: Most design decisions lack basis',
                        3: 'Fair: Many design decisions lack basis',
                        4: 'Below Medium: Some design decisions lack basis',
                        5: 'Medium: Some design decisions have basis, but incomplete',
                        6: 'Above Average: Most design decisions have basis',
                        7: 'Good: Vast majority of design decisions have basis',
                        8: 'Very Good: All design decisions have clear basis',
                        9: 'Excellent: Design decisions fully correspond to requirements',
                        10: 'Outstanding: Design decisions have complete traceability chain to original requirements'
                    },
                    'M3': {
                        0: 'Very Poor: Cannot predict change impact at all',
                        1: 'Poor: Almost cannot predict change impact',
                        2: 'Below Average: Can only predict some obvious impacts',
                        3: 'Fair: Can predict main impacts but miss secondary impacts',
                        4: 'Below Medium: Can predict most impacts but may miss details',
                        5: 'Medium: Can predict main impacts and most secondary impacts',
                        6: 'Above Average: Can predict most impacts, including main and secondary',
                        7: 'Good: Can predict vast majority of impacts, rarely miss any',
                        8: 'Very Good: Can accurately predict all main impacts and most secondary impacts',
                        9: 'Excellent: Can accurately predict all impacts including details and indirect impacts',
                        10: 'Outstanding: Can fully predict all impacts of changes including direct, indirect, and potential impacts'
                    },
                    'M4': {
                        0: 'Very Poor: Team has completely inconsistent understanding of "done"',
                        1: 'Poor: Team has very different understanding of "done"',
                        2: 'Below Average: Team frequently has inconsistent understanding of "done"',
                        3: 'Fair: Team often has inconsistent understanding of "done"',
                        4: 'Below Medium: Team occasionally has inconsistent understanding of "done"',
                        5: 'Medium: Mostly consistent understanding, occasional ambiguity',
                        6: 'Above Average: Team has basically consistent understanding of "done"',
                        7: 'Good: Team has highly consistent understanding of "done"',
                        8: 'Very Good: Team has almost completely consistent understanding of "done"',
                        9: 'Excellent: Team has clear and consistent standards for "done"',
                        10: 'Outstanding: Team has complete and unified definition of "done" with no ambiguity'
                    },
                    'M5': {
                        0: 'Very Poor: Need more than 5 meetings to align',
                        1: 'Poor: Need 4-5 meetings to align',
                        2: 'Below Average: Need 3-4 meetings to align',
                        3: 'Fair: Need 3 meetings to align',
                        4: 'Below Medium: Need 2-3 meetings to align',
                        5: 'Medium: Usually need 2 meetings to align',
                        6: 'Above Average: Need 1-2 meetings to align',
                        7: 'Good: Usually 1 meeting is enough to align',
                        8: 'Very Good: Most cases need only 1 meeting to align',
                        9: 'Excellent: Almost no meetings needed, smooth communication',
                        10: 'Outstanding: No additional meetings needed, extremely efficient communication'
                    }
                }
            };
            
            Object.keys(scoreDescriptions).forEach(metric => {
                scoreDescriptions[metric] = descriptions[lang]?.[metric] || descriptions['zh-TW'][metric];
            });
        }
        
        function updateScoreDescription(sliderId, value) {
            const descElement = document.getElementById(`desc-${sliderId}`);
            if (descElement && scoreDescriptions[sliderId]) {
                // æ›´æ–°åˆ†æ•¸å€¼é¡¯ç¤º
                const valueElement = descElement.querySelector('.score-value-inline');
                if (valueElement) {
                    valueElement.textContent = value;
                }
                
                // æ›´æ–°èªªæ˜æ–‡å­—
                const desc = scoreDescriptions[sliderId][value] || scoreDescriptions[sliderId][5];
                const scoreTextElement = descElement.querySelector('.score-text');
                if (scoreTextElement) {
                    scoreTextElement.textContent = desc;
                }
            }
        }

        // å®šç¾© debounceSave å‡½æ•¸ï¼ˆéœ€è¦åœ¨æ»‘æ¡¿äº‹ä»¶è™•ç†ä¹‹å‰å®šç¾©ï¼‰
        let saveTimeout;
        function debounceSave() {
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(async () => {
                await saveToSession();
            }, 300);
        }

        // Slider value updates
        const sliders = document.querySelectorAll('.slider');
        
        // Load descriptions on page load and language change
        loadScoreDescriptions();
        window.addEventListener('languageChanged', function() {
            loadScoreDescriptions();
            // é‡æ–°æ›´æ–°æ‰€æœ‰æ»‘æ¡¿çš„æè¿°
            sliders.forEach(slider => {
                const value = parseInt(slider.value);
                updateScoreDescription(slider.id, value);
            });
        });
        
        sliders.forEach(slider => {
            // Update on input - åŒæ™‚æ›´æ–°åˆ†æ•¸å’Œèªªæ˜ï¼Œä¸¦ä¿å­˜
            slider.addEventListener('input', function() {
                const value = parseInt(this.value);
                updateScoreDescription(slider.id, value);
                // è§¸ç™¼ debounceSave ä¿å­˜æ•¸æ“š
                debounceSave();
            });

            // Initialize with default value
            const defaultValue = parseInt(slider.value);
            updateScoreDescription(slider.id, defaultValue);
        });

        // ä¿å­˜åˆ° Sessionï¼ˆå®Œå…¨ç§»é™¤ localStorageï¼‰
        async function saveToSession() {
            // æ”¶é›†æ‰€æœ‰å•å·æ•¸æ“š
            const projectNameInput = document.getElementById('projectName');
            const systemNameInput = document.getElementById('systemName');
            const systemCodeInput = document.getElementById('systemCode');
            const evaluatorRoleInput = document.getElementById('evaluatorRole');
            
            const data = {};
            if (projectNameInput) {
                data.projectName = projectNameInput.value;
            }
            if (systemNameInput) {
                data.systemName = systemNameInput.value;
            }
            if (systemCodeInput) {
                data.systemCode = systemCodeInput.value.toUpperCase();
            }
            if (evaluatorRoleInput) {
                data.evaluatorRole = evaluatorRoleInput.value;
            }
            
            const sliders = document.querySelectorAll('.slider');
            sliders.forEach(slider => {
                data[slider.name] = slider.value;
            });
            
            const textareas = document.querySelectorAll('.question-textarea');
            textareas.forEach(textarea => {
                data[textarea.name] = textarea.value;
            });
            
            // æª¢æŸ¥æ˜¯å¦æœ‰ M1-M5 åˆ†æ•¸ï¼ˆç§»é™¤è©³ç´°æ—¥èªŒï¼Œåƒ…ä¿ç•™å¿…è¦çš„éŒ¯èª¤æç¤ºï¼‰
            const hasMValues = data.M1 || data.M2 || data.M3 || data.M4 || data.M5;
            if (!hasMValues) {
                // åƒ…åœ¨é–‹ç™¼ç’°å¢ƒé¡¯ç¤ºè©³ç´°è­¦å‘Š
                if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    console.warn('âš ï¸ è­¦å‘Šï¼šå•å·æ•¸æ“šä¸­æ²’æœ‰ M1-M5 åˆ†æ•¸ï¼');
                }
            }
            
            // ä¿å­˜åˆ°æœå‹™ç«¯ Session
            try {
                const response = await fetch('/Home/SubmitSurvey', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    credentials: 'same-origin', // ç¢ºä¿ç™¼é€ Cookie
                    body: JSON.stringify(data)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('ç„¡æ³•ä¿å­˜åˆ°æœå‹™ç«¯ Session:', response.status, errorText);
                    throw new Error(`ä¿å­˜å¤±æ•—: ${response.status}`);
                } else {
                    const result = await response.json();
                    // ç§»é™¤è©³ç´°æ—¥èªŒï¼ˆå®‰å…¨è€ƒé‡ï¼‰
                    
                    // é©—è­‰æ•¸æ“šæ˜¯å¦çœŸçš„ä¿å­˜æˆåŠŸï¼ˆåƒ…åœ¨é–‹ç™¼ç’°å¢ƒé¡¯ç¤ºï¼‰
                    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                        const verifyResponse = await fetch('/Home/GetSurveyData', {
                            credentials: 'same-origin'
                        });
                        if (verifyResponse.ok) {
                            const verifyResult = await verifyResponse.json();
                            if (!verifyResult.success) {
                                console.error('âœ— é©—è­‰å¤±æ•—ï¼šSession ä¸­æ²’æœ‰æ•¸æ“šï¼');
                            }
                        }
                    }
                }
            } catch (error) {
                console.error('ä¿å­˜åˆ°æœå‹™ç«¯ Session å¤±æ•—:', error);
                throw error; // é‡æ–°æ‹‹å‡ºéŒ¯èª¤ï¼Œè®“èª¿ç”¨è€…çŸ¥é“ä¿å­˜å¤±æ•—
            }
        }

        // å¾ Session è¼‰å…¥å·²ä¿å­˜çš„å•å·æ•¸æ“š
        async function loadSurveyDataFromSession() {
            try {
                const response = await fetch('/Home/GetSurveyData', {
                    credentials: 'same-origin' // ç¢ºä¿ç™¼é€ Cookie
                });
                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.data) {
                        // è¼‰å…¥å°ˆæ¡ˆè³‡è¨Š
                        const projectNameInput = document.getElementById('projectName');
                        const systemNameInput = document.getElementById('systemName');
                        const systemCodeInput = document.getElementById('systemCode');
                        const evaluatorRoleInput = document.getElementById('evaluatorRole');
                        
                        if (projectNameInput && result.data.projectName) {
                            projectNameInput.value = result.data.projectName;
                        }
                        if (systemNameInput && result.data.systemName) {
                            systemNameInput.value = result.data.systemName;
                        }
                        if (systemCodeInput && result.data.systemCode) {
                            systemCodeInput.value = result.data.systemCode;
                        }
                        if (evaluatorRoleInput && result.data.evaluatorRole) {
                            evaluatorRoleInput.value = result.data.evaluatorRole;
                        }
                        
                        // è¼‰å…¥æ»‘æ¡¿å€¼ï¼ˆéœ€è¦é‡æ–°ç²å– slidersï¼Œå› ç‚ºå¯èƒ½åœ¨å‡½æ•¸å¤–éƒ¨å®šç¾©ï¼‰
                        const sliders = document.querySelectorAll('.slider');
                        sliders.forEach(slider => {
                            const savedValue = result.data[slider.id] || result.data[slider.name];
                            if (savedValue !== null && savedValue !== undefined) {
                                slider.value = savedValue;
                                const value = parseInt(savedValue);
                                updateScoreDescription(slider.id, value);
                            }
                        });
                        
                        // è¼‰å…¥æ–‡å­—å€åŸŸ
                        const textareas = document.querySelectorAll('.question-textarea');
                        textareas.forEach(textarea => {
                            const savedValue = result.data[textarea.id] || result.data[textarea.name];
                            if (savedValue !== null && savedValue !== undefined) {
                                textarea.value = savedValue;
                            }
                        });
                        
                        return true; // æˆåŠŸè¼‰å…¥
                    } else {
                        console.warn('Session ä¸­æ²’æœ‰å•å·æ•¸æ“š:', result.message);
                        return false;
                    }
                } else {
                    console.warn('ç²å–å•å·æ•¸æ“šå¤±æ•—ï¼Œç‹€æ…‹ç¢¼:', response.status);
                    return false;
                }
            } catch (error) {
                console.warn('ç„¡æ³•å¾ Session è¼‰å…¥å•å·æ•¸æ“š:', error);
                return false;
            }
        }
        
        // è¼‰å…¥å·²ä¿å­˜çš„å•å·æ•¸æ“š
        loadSurveyDataFromSession();

        // è¼‰å…¥å‰æ¬¡å¡«å¯«çš„è³‡æ–™ï¼ˆæŒ‰éˆ•é»æ“Šæ™‚èª¿ç”¨ï¼‰
        window.loadPreviousData = async function() {
            try {
                const success = await loadSurveyDataFromSession();
                if (!success) {
                    alert('âš ï¸ æ²’æœ‰æ‰¾åˆ°å‰æ¬¡å¡«å¯«çš„è³‡æ–™ï¼Œè«‹å…ˆå¡«å¯«å•å·ã€‚');
                }
            } catch (error) {
                console.error('è¼‰å…¥å‰æ¬¡è³‡æ–™å¤±æ•—:', error);
                alert('âš ï¸ ç„¡æ³•è¼‰å…¥å‰æ¬¡å¡«å¯«çš„è³‡æ–™ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚');
            }
        };

        // ç¢ºä¿ goToPayment å‡½æ•¸åœ¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨
        window.goToPayment = async function() {
            try {
                // å…ˆå„²å­˜å•å·è³‡æ–™åˆ° Sessionï¼ˆç¢ºä¿æ•¸æ“šå·²ä¿å­˜ï¼‰
                await saveToSession();
                
                // ç­‰å¾…ä¸€å°æ®µæ™‚é–“ç¢ºä¿æ•¸æ“šå·²ä¿å­˜åˆ°æœå‹™ç«¯
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // å†æ¬¡é©—è­‰æ•¸æ“šæ˜¯å¦ä¿å­˜æˆåŠŸï¼ˆåƒ…åœ¨é–‹ç™¼ç’°å¢ƒé¡¯ç¤ºè©³ç´°æ—¥èªŒï¼‰
                const verifyResponse = await fetch('/Home/GetSurveyData', {
                    credentials: 'same-origin'
                });
                if (verifyResponse.ok) {
                    const verifyResult = await verifyResponse.json();
                    if (!verifyResult.success) {
                        // ç”Ÿç”¢ç’°å¢ƒä¹Ÿé¡¯ç¤ºéŒ¯èª¤æç¤º
                        alert('âš ï¸ å•å·æ•¸æ“šä¿å­˜å¤±æ•—ï¼Œè«‹é‡æ–°å¡«å¯«å•å·ã€‚');
                        return;
                    }
                }
                
                // å¾æœå‹™ç«¯ç²å–ç¶ ç•Œè¡¨å–®è³‡æ–™
                const response = await fetch('/Home/GetEcpayFormData', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`ç²å–æ”¯ä»˜è³‡æ–™å¤±æ•— (${response.status}): ${errorText}`);
                }
                
                const formData = await response.json();
                
                // æª¢æŸ¥æ˜¯å¦æœ‰éŒ¯èª¤è¨Šæ¯
                if (formData.success === false) {
                    throw new Error(formData.message || 'ç²å–æ”¯ä»˜è³‡æ–™å¤±æ•—');
                }
                
                // å»ºç«‹è¡¨å–®ä¸¦åœ¨æ–°è¦–çª—ä¸­æäº¤åˆ°ç¶ ç•Œ
                // é€™æ¨£åŸè¦–çª—çš„å•å·é é¢ä¸æœƒè¢«å–ä»£ï¼Œç”¨æˆ¶å¯ä»¥çœ‹åˆ°å‰›æ‰å¡«çš„å…§å®¹
                // æ”¯ä»˜å®Œæˆå¾Œï¼Œæ–°è¦–çª—æœƒè·³è½‰å› ReturnURLï¼ˆReport é é¢ï¼‰
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = 'https://payment-stage.ecpay.com.tw/Cashier/AioCheckOut/V5';
                form.target = '_blank'; // åœ¨æ–°è¦–çª—ä¸­æ‰“é–‹æ”¯ä»˜é é¢
                
                // æ·»åŠ æ‰€æœ‰è¡¨å–®æ¬„ä½
                for (const [key, value] of Object.entries(formData)) {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = value;
                    form.appendChild(input);
                }
                
                document.body.appendChild(form);
                
                // åœ¨æ–°è¦–çª—ä¸­æäº¤è¡¨å–®ï¼Œé€™æ¨£åŸè¦–çª—çš„å•å·é é¢ä¸æœƒè¢«å–ä»£
                // æ”¯ä»˜å®Œæˆå¾Œï¼Œæ–°è¦–çª—æœƒè·³è½‰åˆ° ClientBackURLï¼ˆReport é é¢ï¼‰
                form.submit();
                
                // å¯é¸ï¼šæ”¯ä»˜å®Œæˆå¾Œï¼Œå¯ä»¥é€šéç›£è½æ–°è¦–çª—çš„è¨Šæ¯ä¾†æ›´æ–°åŸè¦–çª—
                // ä½†é€™éœ€è¦ä¿®æ”¹ Report é é¢ï¼Œæš«æ™‚ä¸å¯¦ç¾
            } catch (error) {
                console.error('æ”¯ä»˜æµç¨‹éŒ¯èª¤:', error);
                console.error('éŒ¯èª¤è©³æƒ…:', error.message, error.stack);
                alert('å•Ÿå‹•æ”¯ä»˜æµç¨‹å¤±æ•—ï¼š' + (error.message || 'è«‹ç¨å¾Œå†è©¦'));
            }
        };

        // debounceSave å‡½æ•¸å·²ç¶“åœ¨ä¸Šé¢å®šç¾©äº†ï¼Œé€™è£¡åªéœ€è¦ç‚ºå…¶ä»–è¼¸å…¥æ¬„ä½ç¶å®š

        textareas.forEach(textarea => {
            textarea.addEventListener('input', debounceSave);
        });

        if (projectNameInput) {
            projectNameInput.addEventListener('input', debounceSave);
        }
        if (systemNameInput) {
            systemNameInput.addEventListener('input', debounceSave);
        }
        if (evaluatorRoleInput) {
            evaluatorRoleInput.addEventListener('input', debounceSave);
        }
    </script>
}